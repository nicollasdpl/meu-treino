<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <title>Meu Treino</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="theme-color" content="#8b5cf6">
  <!-- PWA -->
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="Meu Treino">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header>
    <h1>Meu Treino</h1>
    <p id="subheader"></p>
    <div class="header-actions">
      <button id="btnTheme" class="small" title="Tema">üåô</button>
      <button id="btnNotify" class="small" title="Notifica√ß√µes">üîï</button>
      <button id="btnLogin" class="small">Entrar</button>
      <button id="btnLogout" class="small" style="display:none">Sair</button>
    </div>
  </header>

  <main>
    <div class="card-mini"><span id="userStatus">Carregando‚Ä¶</span> ¬∑ <span id="syncInfo">Sincroniza√ß√£o: ‚Äî</span></div>

    <!-- HOME -->
    <section id="home" class="pagina" style="display:block">
      <div class="toolbar">
        <h2>Calend√°rio</h2>
      </div>
      <div class="semana-labels"><span>Dom</span><span>Seg</span><span>Ter</span><span>Qua</span><span>Qui</span><span>Sex</span><span>S√°b</span></div>
      <div class="grid-2">
        <div class="card">
          <div class="toolbar">
            <button id="prevMes" class="ghost">‚óÄ</button>
            <h2 id="mesAno" style="margin-left:6px">‚Äî</h2>
            <button id="proxMes" class="ghost">‚ñ∂</button>
            <div class="timer" style="margin-left:auto">
              <button id="btnTimer" class="primary">Iniciar</button>
              <span id="timer">00:00:00</span>
            </div>
          </div>
          <div id="calendario" class="grid-cal"></div>
        </div>
        <div class="card">
          <h3>Resumo</h3>
          <div class="resumo">
            <div class="card-mini"><b id="diasTreinadosMes">0</b><div class="muted small">dias treinados no m√™s</div></div>
            <div class="card-mini"><b id="ultimoTreino">‚Äî</b><div class="muted small">√∫ltimo treino</div></div>
            <div class="card-mini"><b id="duracaoMedia">‚Äî</b><div class="muted small">dura√ß√£o m√©dia</div></div>
          </div>
        </div>
      </div>
    </section>

    <!-- TREINO -->
    <section id="treino" class="pagina" style="display:none">
      <div class="toolbar">
        <h2>Treino</h2>
        <div class="timer">
          <button id="btnTimer" class="primary">Iniciar</button>
          <span id="timer">00:00:00</span>
        </div>
      </div>

      <div class="tabs">
        <button class="tab-btn" data-dia="segunda">Seg</button>
        <button class="tab-btn" data-dia="terca">Ter</button>
        <button class="tab-btn" data-dia="quarta">Qua</button>
        <button class="tab-btn" data-dia="quinta">Qui</button>
        <button class="tab-btn" data-dia="sexta">Sex</button>
      </div>

      <div class="card rest-controls">
        <b>Descanso</b> ¬∑
        <label>segundos: <input id="restSeg" type="number" value="60"></label>
        <button id="btnRest" class="ghost">‚è±Ô∏è Iniciar</button>
        <span id="restDisplay" class="muted">‚Äî</span>
      </div>

      <p class="hint" id="treinoDoDia">Dia selecionado: ‚Äî</p>
      <div id="listaExercicios"></div>

      <div class="toolbar">
        <button id="btnCopyLast" class="ghost">Copiar √∫ltima sess√£o</button>
        <button id="salvarTreino" class="success">Salvar sess√£o</button>
        <span id="statusSave" class="muted"></span>
      </div>
      <!-- Tonelagem do dia aparece aqui (inserido pelo JS) -->
    </section>

    <!-- EVOLU√á√ÉO -->
    <section id="graficos" class="pagina" style="display:none">
      <div class="toolbar"><h2>Evolu√ß√£o</h2></div>

      <!-- KPIs -->
      <div class="resumo">
        <div class="card-mini"><b id="kpi7dSessoes">0</b><div class="muted small">treinos nos √∫ltimos 7 dias</div></div>
        <div class="card-mini"><b id="kpi7dVolume">0</b><div class="muted small">volume 7d (kg¬∑reps)</div></div>
        <div class="card-mini"><b id="kpiStreak">0</b><div class="muted small">maior sequ√™ncia (dias)</div></div>
      </div>

      <!-- PRs -->
      <div class="card">
        <h3>Recordes pessoais (PR)</h3>
        <div id="listaPRs" class="grid-2"></div>
      </div>

      <!-- Filtros -->
      <div class="card">
        <div class="chips" id="filtroDia">
          <button class="chip active" data-dia="all">Todos</button>
          <button class="chip" data-dia="segunda">Seg</button>
          <button class="chip" data-dia="terca">Ter</button>
          <button class="chip" data-dia="quarta">Qua</button>
          <button class="chip" data-dia="quinta">Qui</button>
          <button class="chip" data-dia="sexta">Sex</button>
        </div>
        <div class="toolbar">
          <label>Per√≠odo:
            <select id="periodo">
              <option value="30">30 dias</option>
              <option value="60">60 dias</option>
              <option value="90" selected>90 dias</option>
              <option value="180">180 dias</option>
              <option value="365">1 ano</option>
            </select>
          </label>
          <label style="margin-left:auto">Exerc√≠cio:
            <select id="selectExercicio"></select>
          </label>
        </div>
        <div class="card">
          <canvas id="chartCanvas" height="220"></canvas>
        </div>
        <div class="card">
          <canvas id="volumeCanvas" height="220"></canvas>
        </div>
      </div>

      <div class="card">
        <h3>Sess√µes recentes</h3>
        <div id="listaSessoesDetalhe"></div>
      </div>
    </section>

    <!-- PERFIL / H√ÅBITOS -->
    <section id="perfil" class="pagina" style="display:none">
      <div class="toolbar"><h2>Perfil & Rotina</h2></div>

      <div class="card profile-card">
        <img id="userPhoto" alt="Foto" src="" />
        <div>
          <div><b id="userName">Visitante</b></div>
          <div class="muted small">Entre com Google para sincronizar foto, nome e seus dados.</div>
        </div>
      </div>

      <div class="card">
        <h3>H√°bitos do dia</h3>
        <div class="habits-grid" id="habitsGrid">
          <!-- checkboxes (JS preenche estado) -->
          <label><input type="checkbox" data-habit="cafe"> Caf√© da manh√£</label>
          <label><input type="checkbox" data-habit="lanche_manha"> Lanche da manh√£</label>
          <label><input type="checkbox" data-habit="almoco_ok"> Almo√ßo ‚Äúlimpo‚Äù</label>
          <label><input type="checkbox" data-habit="lanche_tarde"> Lanche da tarde</label>
          <label><input type="checkbox" data-habit="pre_treino"> Pr√©-treino</label>
          <label><input type="checkbox" data-habit="pos_treino"> P√≥s-treino</label>
          <label><input type="checkbox" data-habit="creatina"> Creatina</label>
          <label><input type="checkbox" data-habit="agua_25"> √Ågua (‚â• 2,5 L)</label>
          <label><input type="checkbox" data-habit="alongar"> Alongar</label>
          <label><input type="checkbox" data-habit="dormir7h"> Dormir ‚â• 7h</label>
          <label><input type="checkbox" data-habit="acordar_hora"> Acordar no hor√°rio</label>
          <label><input type="checkbox" data-habit="passos8k"> Passos ‚â• 8k</label>
        </div>
        <div class="toolbar">
          <button id="btnSalvarHabitos" class="success">Salvar h√°bitos de hoje</button>
          <span id="statusHabitos" class="muted"></span>
        </div>
      </div>

      <div class="grid-2">
        <div class="card">
          <h3>Resumo da semana</h3>
          <ul id="resumoHabitosSemana" class="small" style="margin:0;padding-left:18px"></ul>
        </div>
        <div class="card">
          <h3>Hist√≥rico (7 dias)</h3>
          <div id="historicoHabitos" class="card-mini"></div>
        </div>
      </div>
    </section>
  </main>

  <!-- NAV -->
  <nav>
    <button onclick="mostrarPagina('home')">üè†</button>
    <button onclick="mostrarPagina('treino')">üèãÔ∏è</button>
    <button onclick="mostrarPagina('graficos')">üìà</button>
    <button onclick="mostrarPagina('perfil')">üë§</button>
  </nav>

  <!-- OVERLAY descanso -->
  <div id="restOverlay" class="overlay hidden">
    <div class="modal">
      <h3>‚è∞ Descanso finalizado!</h3>
      <p class="muted">Hora da pr√≥xima s√©rie.</p>
      <div class="stack">
        <button id="btnOverlayOk" class="success">Beleza</button>
        <button id="btnOverlayBuzz" class="ghost">üîî Tocar / Vibrar</button>
      </div>
    </div>
  </div>

  <script type="module" src="script.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./sw.js').catch(console.error);
    }
  </script>
</body>
</html>
